import{u as H,a as J,i as K,c as Q,r as I,z as X,b as Y,d as V,w as Z,e as ee,f as p,g as a,h as t,j as c,k as n,m as i,n as te,F as m,o,V as _,p as b,q as w,s as h,t as f,v as g,x as oe,A as U,y as ae}from"./index-CkvOASA5.js";import{V as le,a as F,b as re,c as ne}from"./VNavigationDrawer-DImx0hlO.js";import{V as G}from"./VContainer-D52yVQUi.js";import{V as d,a as L,b as W}from"./VList-Dal6FRzI.js";import{V as $}from"./VChip-Kv2TYpHV.js";import{V as D}from"./VDivider-CCrHKZeK.js";const se={class:"d-flex mr-6"},ie={class:"d-flex"},ue={class:"d-flex flex-column ml-3 justify-center"},ce={class:"mr-3"},de={class:"d-flex justify-space-between align-center"},_e={__name:"members",setup(pe){const{t:v}=H(),r=J(),{apiAuth:C}=ae(),O=K(),M=Q(),z=I([]),N=X(),{mdAndUp:y}=Y(),P=V(()=>r.tags),k=I(!1),s=I(!1),A=I(new URL("/game-together/assets/logo-FHMshnbs.png",import.meta.url).href),B=V(()=>[{to:"/group",text:v("nav.groupList"),icon:"mdi-invoice-list-outline",show:r.isLoggedIn||!r.isLoggedIn},{to:"/creategroup/step1",text:v("nav.groupCreate"),icon:"mdi-flag-outline",show:r.isLoggedIn||!r.isLoggedIn},{to:"/member/organizer",text:v("nav.membersSection"),icon:"mdi-account-group",show:r.isLoggedIn},{to:"/admin/groups",text:v("nav.adminSection"),icon:"mdi-cog",show:r.isLoggedIn&&r.isAdmin},{to:"/contact",text:v("nav.contactUs"),icon:"mdi-chat",show:r.isLoggedIn||!r.isLoggedIn},{to:"/login",text:v("nav.login"),icon:"mdi-account-arrow-left",show:!r.isLoggedIn},{to:"/register",text:v("nav.register"),icon:"mdi-account-plus",show:!r.isLoggedIn}]),R=V(()=>[{title:"主辦的揪團",icon:"",to:"/member/organizer"},{title:"參加的揪團",icon:"",to:"/member/participation"},{title:"收藏的揪團",icon:"",to:"/member/favorites"}]),T=V(()=>[{title:"個人資訊",icon:"",to:"/member/info"},{title:"個人標籤",icon:"",to:"/member/tag"}]),j=async()=>{try{await C.delete("/user/logout")}catch(u){console.log(u)}r.logout(),O({text:v("logout.success"),snackbarProps:{color:"green"}}),k.value=!1,M.push("/")};(async()=>{try{const u=await Promise.all([C.get("/user/organizerGroup"),C.get("/user/joinGroup")]);for(let l=0;l<u.length;l++)z.value.push(...u[l].data.result)}catch(u){console.log(u)}})();const S=V(()=>{const u=N.startOfWeek(new Date),l=N.endOfWeek(new Date);return z.value.filter(x=>{const e=new Date(x.group_id.time),q=e>=u&&e<=l,E=e>=new Date;return q&&E}).sort((x,e)=>new Date(x.group_id.time)-new Date(e.group_id.time)).slice(0,3)});return Z(y,u=>{console.log(u),u&&(k.value&&(k.value=!1),s.value&&(s.value=!1)),u||s.value||(s.value=!0)}),(u,l)=>{const x=ee("router-view");return o(),p(m,null,[a(le,null,{default:t(()=>[c(y)?(o(),n(G,{key:0,class:"d-flex justify-space-between align-center",fluid:"",style:{"max-width":"1440px"}},{default:t(()=>[a(_,{to:"/",active:!1,class:"ml-2",height:"60",ripple:!1},{default:t(()=>[a(b,{image:A.value,rounded:"0",size:"65"},null,8,["image"])]),_:1}),w("div",se,[(o(!0),p(m,null,h(B.value,e=>(o(),p(m,{key:e.to},[e.show?(o(),n(_,{key:0,to:e.to,"prepend-icon":e.icon},{default:t(()=>[f(g(e.text),1)]),_:2},1032,["to","prepend-icon"])):i("",!0)],64))),128)),c(r).isLoggedIn?(o(),n(_,{key:0,"prepend-icon":"mdi-account-arrow-right",onClick:j},{default:t(()=>[f(g(u.$t("nav.logout")),1)]),_:1})):i("",!0),a(b,{border:"xs",image:c(r).avatar},null,8,["image"])])]),_:1})):c(y)?i("",!0):(o(),n(G,{key:1,class:"d-flex justify-space-between align-center",fluid:""},{default:t(()=>[a(_,{to:"/",active:!1,class:"ml-2",height:"60",ripple:!1},{default:t(()=>[a(b,{image:A.value,rounded:"0",size:"65"},null,8,["image"])]),_:1}),a(ne,{onClick:l[0]||(l[0]=e=>k.value=!k.value),class:"mr-6"})]),_:1}))]),_:1}),c(y)?i("",!0):(o(),n(F,{key:0,modelValue:k.value,"onUpdate:modelValue":l[2]||(l[2]=e=>k.value=e),temporary:"",location:"top"},{default:t(()=>[a(L,null,{default:t(()=>[(o(!0),p(m,null,h(B.value,e=>(o(),p(m,null,[e.show?(o(),n(d,{key:0,to:e.to,"prepend-icon":e.icon},{default:t(()=>[f(g(e.text),1)]),_:2},1032,["to","prepend-icon"])):i("",!0)],64))),256)),c(r).isLoggedIn?(o(),n(d,{key:0,onClick:l[1]||(l[1]=()=>{j(),k.value=!1}),"prepend-icon":"mdi-account-arrow-right"},{default:t(()=>[f(g(u.$t("nav.logout")),1)]),_:1})):i("",!0)]),_:1})]),_:1},8,["modelValue"])),a(F,{permanent:"",rail:s.value,"rail-width":"90",drawer:"drawer",onClick:l[4]||(l[4]=e=>c(y)?null:s.value=!1),width:"260",class:te({"cursor-pointer":s.value})},{default:t(()=>[s.value?(o(),n(L,{key:0},{default:t(()=>[a(d,null,{default:t(()=>[a(b,{image:c(r).avatar,size:"50"},null,8,["image"])]),_:1})]),_:1})):i("",!0),s.value?i("",!0):(o(),n(L,{key:1},{default:t(()=>[a(d,null,{default:t(()=>[w("div",ie,[a(b,{image:c(r).avatar,size:"50"},null,8,["image"]),w("div",ue,[w("span",ce,g(c(r).nickname),1),w("span",null,g(c(r).email),1)]),c(y)?i("",!0):(o(),n(_,{key:0,icon:"mdi-chevron-left",size:"40",variant:"text",onClick:l[3]||(l[3]=oe(e=>s.value=!0,["stop"]))}))])]),_:1}),a(d,null,{default:t(()=>[(o(!0),p(m,null,h(P.value,e=>(o(),n($,{"prepend-icon":"mdi-tag",key:e,class:"mr-2 mb-1 pt-1",size:"small",variant:"outlined"},{default:t(()=>[f(g(e),1)]),_:2},1024))),128))]),_:1})]),_:1})),s.value?i("",!0):(o(),n(D,{key:2})),s.value?i("",!0):(o(),n(L,{key:3},{default:t(()=>[a(W,{value:"Numbers"},{activator:t(({props:e})=>[a(d,U(e,{"prepend-icon":"mdi-account-circle",title:"我的揪團"}),null,16)]),default:t(()=>[(o(!0),p(m,null,h(R.value,e=>(o(),n(d,{key:e.to,"prepend-icon":e.icon,title:e.title,to:e.to},null,8,["prepend-icon","title","to"]))),128))]),_:1})]),_:1})),s.value?i("",!0):(o(),n(L,{key:4},{default:t(()=>[a(W,{value:"Users"},{activator:t(({props:e})=>[a(d,U(e,{"prepend-icon":"mdi-account-circle",title:"我的資訊"}),null,16)]),default:t(()=>[(o(!0),p(m,null,h(T.value,e=>(o(),n(d,{key:e.to,"prepend-icon":e.icon,title:e.title,to:e.to},null,8,["prepend-icon","title","to"]))),128))]),_:1})]),_:1})),s.value?i("",!0):(o(),n(D,{key:5})),s.value?i("",!0):(o(),n(d,{key:6,class:"w-100"},{default:t(()=>[w("div",de,[l[6]||(l[6]=w("span",{class:"font-weight-bold"},"本周揪團",-1)),a(_,{to:"/member/date","append-icon":"mdi-arrow-top-right",variant:"text",ripple:!1,active:!1},{default:t(()=>l[5]||(l[5]=[f(" 詳細月曆 ")])),_:1})])]),_:1})),s.value?i("",!0):(o(!0),p(m,{key:7},h(S.value,e=>(o(),p(m,null,[a(D),a(d,{style:{"font-size":"14px"}},{default:t(()=>[f(g(e.group_id.name)+" "+g(e.group_id.type)+" ",1),a($,{class:"ml-1","prepend-icon":"mdi-clock-time-four-outline"},{default:t(()=>[f(g(new Date(e.group_id.time).toLocaleDateString()),1)]),_:2},1024)]),_:2},1024)],64))),256)),s.value?i("",!0):(o(),n(D,{key:8})),S.value.length===0&&!s.value?(o(),n(d,{key:9},{default:t(()=>l[7]||(l[7]=[f("本周無揪團")])),_:1})):i("",!0)]),_:1},8,["rail","class"]),a(re,null,{default:t(()=>[a(x)]),_:1})],64)}}};export{_e as default};
