import{r as v,ax as h,u as F,i as I,d as U,o as V,f as b,g as l,h as a,q as u,v as s,ao as j,t as c,V as d,ap as x,at as P,j as w,ay as q,au as D,F as _,s as R,aw as $,av as z,k as G,y as H}from"./index-Bx7NXiC_.js";import{b as T}from"./route-block-B_A1xBdJ.js";import{V as J,a as A}from"./VRow-CeCUGQ1I.js";import{V as K}from"./VDataTable-BMVVmf3j.js";import{V as M}from"./VContainer-kqHsgsxC.js";import{a as O,V as Q}from"./VList-z6oXqUdq.js";import"./VPagination-Cb0EAhg-.js";import"./VSelect-CzFRWA8R.js";import"./VMenu-C_WnRdHJ.js";import"./VChip-CrISLV3z.js";import"./VDivider-D2cu2Qzk.js";const W={class:"text-center mb-2"},X={class:"d-flex justify-center mb-5"},Y={__name:"contacts",setup(Z){const m=v(""),f=h([]),{t:i}=F(),{apiAuth:k}=H(),g=I(),B=[{title:i("admin.contactName"),key:"nickname",sortable:!0},{title:i("admin.contactEmail"),key:"email",sortable:!0},{title:i("admin.contactTitle"),key:"title",sortable:!0},{title:i("admin.contactDescription"),key:"description",sortable:!0},{title:i("admin.contactDate"),key:"createdAt",sortable:!0},{title:"",key:"action",sortable:!1},{title:"",key:"delete",sortable:!1}],L=U(()=>[{title:i("admin.contactName"),value:n.value.nickname},{title:i("admin.contactEmail"),value:n.value.email},{title:i("admin.contactTitle"),value:n.value.title},{title:i("admin.contactDescription"),value:n.value.description}]),y=async()=>{var o,t;try{const{data:e}=await k.get("/contactform/all");f.push(...e.result)}catch(e){console.log(e),g({text:i("api."+(((t=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"red"}})}};y();const N=async o=>{console.log(o);try{await k.delete("/contactform/"+o._id),f.length=0,await y(),g({text:i("admin.contactDeleted"),snackbarProps:{color:"green"}})}catch(t){console.log(t)}},n=v({open:!1,id:"",nickname:"",email:"",title:"",description:""}),r=v({open:!1,data:""}),E=o=>{r.value.open=!0,r.value.data=o},C=o=>{o==="cancel"?r.value.open=!1:o==="confirm"&&(N(r.value.data),r.value.open=!1)},S=o=>{n.value.id=o._id,n.value.nickname=o.nickname,n.value.email=o.email,n.value.title=o.title,n.value.description=o.description,n.value.open=!0};return(o,t)=>(V(),b(_,null,[l(M,{class:"admin__contact","max-width":"1440"},{default:a(()=>[l(J,null,{default:a(()=>[l(A,{cols:"11",offset:"0","offset-sm":"0","offset-md":"0","offset-lg":"0","offset-xl":"1"},{default:a(()=>[u("h1",W,s(o.$t("nav.adminContacts")),1),l(A,{cols:"12"},{default:a(()=>[u("div",X,[l(j,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),"prepend-inner-icon":"mdi-magnify",variant:"outlined","max-width":"500"},null,8,["modelValue"])]),l(K,{items:f,headers:B,search:m.value},{"item.description":a(({value:e})=>[u("span",null,s(e.length>20?e.slice(0,20)+"...":e),1)]),"item.createdAt":a(({value:e})=>[c(s(new Date(e).toLocaleString()),1)]),"item.action":a(({item:e})=>[l(d,{onClick:p=>S(e)},{default:a(()=>[c(s(o.$t("admin.contactView")),1)]),_:2},1032,["onClick"])]),"item.delete":a(({item:e})=>[l(d,{onClick:p=>E(e)},{default:a(()=>[c(s(o.$t("admin.contactDelete")),1)]),_:2},1032,["onClick"])]),_:2},1032,["items","search"])]),_:1})]),_:1})]),_:1})]),_:1}),l($,{modelValue:n.value.open,"onUpdate:modelValue":t[2]||(t[2]=e=>n.value.open=e),"max-width":"400"},{default:a(()=>[l(x,null,{default:a(()=>[l(P,{class:"d-flex align-center mb-0 pb-0"},{default:a(()=>[u("span",null,s(w(i)("adminContact.view")),1),l(q),l(d,{icon:"mdi-close",variant:"text",onClick:t[1]||(t[1]=e=>n.value.open=!1)})]),_:1}),l(D,{class:"pt-0"},{default:a(()=>[l(O,null,{default:a(()=>[(V(!0),b(_,null,R(w(L),(e,p)=>(V(),G(Q,{class:"py-0",key:p},{default:a(()=>[c(s(e.title)+": "+s(e.value),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l($,{modelValue:r.value.open,"onUpdate:modelValue":t[5]||(t[5]=e=>r.value.open=e),width:"350"},{default:a(()=>[l(x,null,{default:a(()=>[l(D,null,{default:a(()=>t[6]||(t[6]=[c("確定要刪除揪團嗎?")])),_:1}),l(z,null,{default:a(()=>[l(d,{onClick:t[3]||(t[3]=e=>C("cancel"))},{default:a(()=>t[7]||(t[7]=[c("取消")])),_:1}),l(d,{onClick:t[4]||(t[4]=e=>C("confirm"))},{default:a(()=>t[8]||(t[8]=[c("確定")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};typeof T=="function"&&T(Y);export{Y as default};
