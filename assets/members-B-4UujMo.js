import{u as K,a as Q,i as X,A as Y,b as Z,r as I,w as ee,o as te,c as p,d as a,e as o,f as u,g as r,j as i,n as oe,F as m,z as ae,k as le,l as re,m as t,V as y,p as V,q as _,s as h,t as f,v as g,x as F,B as G,y as b}from"./index-DGDPAFvN.js";import{V as ne,a as W,b as se,c as ie}from"./VNavigationDrawer-CaVKMa-f.js";import{V as $}from"./VContainer-DRMGm2hx.js";import{V as L,a as d,b as M}from"./VList-D0O-dBcK.js";import{V as O}from"./VChip-BLJmKbnz.js";import{V as D}from"./VDivider-C7U-UNkw.js";const ue={class:"d-flex mr-6"},de={class:"d-flex"},ce={class:"d-flex flex-column ml-3 justify-center"},pe={class:"mr-3"},me={class:"d-flex justify-space-between align-center"},xe={__name:"members",setup(ge){const{t:v}=K(),n=Q(),{apiAuth:z}=ae(),P=X(),R=le(),C=I([]),N=Y(),{mdAndUp:k}=Z(),T=b(()=>n.tags),w=I(!1),s=I(!1),A=I(new URL("/game-together/assets/logo-FHMshnbs.png",import.meta.url).href),B=b(()=>[{to:"/group",text:v("nav.groupList"),icon:"mdi-invoice-list-outline",show:n.isLoggedIn||!n.isLoggedIn},{to:"/creategroup/step1",text:v("nav.groupCreate"),icon:"mdi-flag-outline",show:n.isLoggedIn||!n.isLoggedIn},{to:"/member/organizer",text:v("nav.membersSection"),icon:"mdi-account-group",show:n.isLoggedIn},{to:"/admin/groups",text:v("nav.adminSection"),icon:"mdi-cog",show:n.isLoggedIn&&n.isAdmin},{to:"/contact",text:v("nav.contactUs"),icon:"mdi-chat",show:n.isLoggedIn||!n.isLoggedIn},{to:"/login",text:v("nav.login"),icon:"mdi-account-arrow-left",show:!n.isLoggedIn},{to:"/register",text:v("nav.register"),icon:"mdi-account-plus",show:!n.isLoggedIn}]),q=b(()=>[{title:"主辦的揪團",icon:"",to:"/member/organizer"},{title:"參加的揪團",icon:"",to:"/member/participation"},{title:"收藏的揪團",icon:"",to:"/member/favorites"}]),E=b(()=>[{title:"個人資訊",icon:"",to:"/member/info"},{title:"個人標籤",icon:"",to:"/member/tag"}]),j=async()=>{try{await z.delete("/user/logout")}catch(c){console.log(c)}n.logout(),P({text:v("logout.success"),snackbarProps:{color:"green"}}),w.value=!1,R.push("/")};(async()=>{try{const c=await Promise.all([z.get("/user/organizerGroup"),z.get("/user/joinGroup")]);for(let l=0;l<c.length;l++)C.value.push(...c[l].data.result)}catch(c){console.log(c)}})();const S=b(()=>{const c=N.startOfWeek(new Date),l=N.endOfWeek(new Date);return C.value.filter(x=>{const e=new Date(x.group_id.time),H=e>=c&&e<=l,J=e>=new Date;return H&&J}).sort((x,e)=>new Date(x.group_id.time)-new Date(e.group_id.time)).slice(0,3)}),U=()=>{k.value&&(w.value&&(w.value=!1),s.value&&(s.value=!1)),k.value||s.value||(s.value=!0)};return ee(k,U),te(U),(c,l)=>{const x=re("router-view");return t(),p(m,null,[a(ne,null,{default:o(()=>[u(k)?(t(),r($,{key:0,class:"d-flex justify-space-between align-center",fluid:"",style:{"max-width":"1440px"}},{default:o(()=>[a(y,{to:"/",active:!1,class:"ml-2",height:"60",ripple:!1},{default:o(()=>[a(V,{image:A.value,rounded:"0",size:"65"},null,8,["image"])]),_:1}),_("div",ue,[(t(!0),p(m,null,h(B.value,e=>(t(),p(m,{key:e.to},[e.show?(t(),r(y,{key:0,to:e.to,"prepend-icon":e.icon},{default:o(()=>[f(g(e.text),1)]),_:2},1032,["to","prepend-icon"])):i("",!0)],64))),128)),u(n).isLoggedIn?(t(),r(y,{key:0,"prepend-icon":"mdi-account-arrow-right",onClick:j},{default:o(()=>[f(g(c.$t("nav.logout")),1)]),_:1})):i("",!0),a(V,{border:"xs",image:u(n).avatar},null,8,["image"])])]),_:1})):u(k)?i("",!0):(t(),r($,{key:1,class:"d-flex justify-space-between align-center",fluid:""},{default:o(()=>[a(y,{to:"/",active:!1,class:"ml-2",height:"60",ripple:!1},{default:o(()=>[a(V,{image:A.value,rounded:"0",size:"65"},null,8,["image"])]),_:1}),a(ie,{onClick:l[0]||(l[0]=e=>w.value=!w.value),class:"mr-6"})]),_:1}))]),_:1}),u(k)?i("",!0):(t(),r(W,{key:0,modelValue:w.value,"onUpdate:modelValue":l[2]||(l[2]=e=>w.value=e),temporary:"",location:"top"},{default:o(()=>[a(L,null,{default:o(()=>[(t(!0),p(m,null,h(B.value,e=>(t(),p(m,null,[e.show?(t(),r(d,{key:0,to:e.to,"prepend-icon":e.icon},{default:o(()=>[f(g(e.text),1)]),_:2},1032,["to","prepend-icon"])):i("",!0)],64))),256)),u(n).isLoggedIn?(t(),r(d,{key:0,onClick:l[1]||(l[1]=()=>{j(),w.value=!1}),"prepend-icon":"mdi-account-arrow-right"},{default:o(()=>[f(g(c.$t("nav.logout")),1)]),_:1})):i("",!0)]),_:1})]),_:1},8,["modelValue"])),a(W,{permanent:"",rail:s.value,"rail-width":"70",drawer:"drawer",width:"260",class:oe({"border-0":s.value})},{default:o(()=>[s.value?(t(),r(L,{key:0},{default:o(()=>[a(d,null,{default:o(()=>[s.value?i("",!0):(t(),r(V,{key:0,image:u(n).avatar,size:"50"},null,8,["image"])),u(k)?i("",!0):(t(),r(y,{key:1,icon:"mdi-chevron-right",size:"40",variant:"text",onClick:l[3]||(l[3]=F(e=>s.value=!1,["stop"])),class:"border-sm"}))]),_:1})]),_:1})):i("",!0),s.value?i("",!0):(t(),r(L,{key:1},{default:o(()=>[a(d,null,{default:o(()=>[_("div",de,[a(V,{image:u(n).avatar,size:"50"},null,8,["image"]),_("div",ce,[_("span",pe,g(u(n).nickname),1),_("span",null,g(u(n).email),1)]),u(k)?i("",!0):(t(),r(y,{key:0,icon:"mdi-chevron-left",size:"40",variant:"text",onClick:l[4]||(l[4]=F(e=>s.value=!0,["stop"]))}))])]),_:1}),a(d,null,{default:o(()=>[(t(!0),p(m,null,h(T.value,e=>(t(),r(O,{"prepend-icon":"mdi-tag",key:e,class:"mr-2 mb-1 pt-1",size:"small",variant:"outlined"},{default:o(()=>[f(g(e),1)]),_:2},1024))),128))]),_:1})]),_:1})),s.value?i("",!0):(t(),r(D,{key:2})),s.value?i("",!0):(t(),r(L,{key:3},{default:o(()=>[a(M,{value:"Numbers"},{activator:o(({props:e})=>[a(d,G(e,{"prepend-icon":"mdi-account-group",title:"我的揪團"}),null,16)]),default:o(()=>[(t(!0),p(m,null,h(q.value,e=>(t(),r(d,{key:e.to,"prepend-icon":e.icon,title:e.title,to:e.to},null,8,["prepend-icon","title","to"]))),128))]),_:1})]),_:1})),s.value?i("",!0):(t(),r(L,{key:4},{default:o(()=>[a(M,{value:"Users"},{activator:o(({props:e})=>[a(d,G(e,{"prepend-icon":"mdi-account-circle",title:"我的資訊"}),null,16)]),default:o(()=>[(t(!0),p(m,null,h(E.value,e=>(t(),r(d,{key:e.to,"prepend-icon":e.icon,title:e.title,to:e.to},null,8,["prepend-icon","title","to"]))),128))]),_:1})]),_:1})),s.value?i("",!0):(t(),r(D,{key:5})),s.value?i("",!0):(t(),r(d,{key:6,class:"w-100"},{default:o(()=>[_("div",me,[l[6]||(l[6]=_("span",{class:"font-weight-bold"},"本周揪團",-1)),a(y,{to:"/member/date","append-icon":"mdi-arrow-top-right",variant:"text",ripple:!1,active:!1},{default:o(()=>[...l[5]||(l[5]=[f(" 詳細月曆 ",-1)])]),_:1})])]),_:1})),s.value?i("",!0):(t(!0),p(m,{key:7},h(S.value,e=>(t(),p(m,null,[a(D),a(d,{style:{"font-size":"14px"}},{default:o(()=>[f(g(e.group_id.name)+" "+g(e.group_id.type)+" ",1),a(O,{class:"ml-1 mt-2","prepend-icon":"mdi-clock-time-four-outline",variant:"outlined",color:"orange"},{default:o(()=>[f(g(new Date(e.group_id.time).toLocaleDateString()),1)]),_:2},1024)]),_:2},1024)],64))),256)),s.value?i("",!0):(t(),r(D,{key:8})),S.value.length===0&&!s.value?(t(),r(d,{key:9},{default:o(()=>[...l[7]||(l[7]=[f("本周無揪團",-1)])]),_:1})):i("",!0)]),_:1},8,["rail","class"]),a(se,null,{default:o(()=>[a(x)]),_:1})],64)}}};export{xe as default};
