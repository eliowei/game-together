import{A as $,m as l,g as D,e as r,d as n,q as _,v as C,V as S,t as L,f,c,F as w,s as B,j as P,B as R,h as T,y as m,r as V,z as j}from"./index-DGDPAFvN.js";import{_ as I}from"./GroupCard-DKKhjWph.js";import{b as A}from"./route-block-B_A1xBdJ.js";import{V as M,a as d}from"./VRow-B0E1-WBI.js";import{V as O}from"./VDivider-C7U-UNkw.js";import{V as q}from"./VPagination-k2GtoYxE.js";import{V as z}from"./VContainer-DRMGm2hx.js";import"./VChip-BLJmKbnz.js";const K={class:"text-h6 mb-3"},U={key:0,class:"text-center"},p=3,H={__name:"favorites",setup(J){const{apiAuth:E}=j(),u=V(1),F=m(()=>Math.ceil(x.value/p)),y=$(),v=V([]),g=V(1),h=m(()=>{const t=v.value.filter(s=>{const a=new Date(s.group_id.time),i=new Date;switch(g.value){case 1:return a>=i;case 2:return a<i;default:return!0}}),e={},o=new Date().toLocaleDateString();return e[o]=[],t.forEach(s=>{const a=new Date(s.group_id.time).toLocaleDateString();e[a]||(e[a]=[]),e[a].push(s)}),Object.entries(e).map(([s,a])=>({date:s,groups:a.sort((i,N)=>new Date(i.group_id.time)-new Date(N.group_id.time))})).sort((s,a)=>new Date(s.date)-new Date(a.date))}),x=m(()=>h.value.reduce((t,e)=>t+e.groups.length,0)),k=m(()=>{const t=[];let e=0;const o=new Date().toLocaleDateString();for(const s of h.value){const a={date:s.date,groups:[]};for(const i of s.groups)e>=(u.value-1)*p&&e<u.value*p&&a.groups.push(i),e++;(a.groups.length>0||s.date===o&&u.value===1&&g.value===1)&&t.push(a)}return t}),b=t=>{g.value=t,u.value=1},G=m(()=>k.value.some(t=>t.groups.length>0||t.date===new Date().toLocaleDateString()&&g.value===1));return(async()=>{const{data:t}=await E.get("/user/favoriteGroup");v.value.push(...t.result),console.log(v.value)})(),(t,e)=>(l(),D(z,{"max-width":"1440"},{default:r(()=>[n(M,null,{default:r(()=>[n(d,{cols:"11","offset-sm":"1","offset-md":"1","offset-lg":"1","offset-xl":"1"},{default:r(()=>[_("h1",null,C(t.$t("member.favorite")),1)]),_:1}),n(d,{cols:"11",offset:"1"},{default:r(()=>[n(S,{onClick:e[0]||(e[0]=o=>b(1)),class:"mr-3"},{default:r(()=>[...e[3]||(e[3]=[L("將要開始",-1)])]),_:1}),n(S,{onClick:e[1]||(e[1]=o=>b(2))},{default:r(()=>[...e[4]||(e[4]=[L("已結束",-1)])]),_:1})]),_:1}),f(G)?(l(!0),c(w,{key:0},B(f(k),o=>(l(),c(w,{key:o.date},[n(d,{cols:"11",offset:"0","offset-sm":"1",sm:"11","offset-md":"1",md:"8","offset-lg":"1",lg:"8","offset-xl":"1",xl:"8"},{default:r(()=>[_("div",K,C(o.date===new Date().toLocaleDateString()?"今天":f(y).format(o.date,"weekday")+" "+f(y).format(o.date,"monthAndDate")),1),n(O,{class:"border-opacity-100 mb-8"}),!o.groups.length&&o.date===new Date().toLocaleDateString()?(l(),c("div",U," 今天沒有符合條件的揪團 ")):P("",!0)]),_:2},1024),n(d,{cols:"12",offset:"0","offset-sm":"1",sm:"12","offset-md":"1",md:"8","offset-lg":"1",lg:"8","offset-xl":"1",xl:"8"},{default:r(()=>[(l(!0),c(w,null,B(o.groups,s=>(l(),c("div",{key:s._id},[n(I,R({ref_for:!0},s.group_id),null,16)]))),128))]),_:2},1024)],64))),128)):(l(),D(d,{key:1,cols:"12",class:"text-center"},{default:r(()=>[...e[5]||(e[5]=[_("div",{class:"text-h6 text-grey"},"沒有符合條件的揪團",-1)])]),_:1})),n(d,{cols:"12"},{default:r(()=>[f(x)>p?(l(),D(q,{key:0,modelValue:f(u),"onUpdate:modelValue":e[2]||(e[2]=o=>T(u)?u.value=o:null),length:f(F),class:"group__pagination"},null,8,["modelValue","length"])):P("",!0)]),_:1})]),_:1})]),_:1}))}};typeof A=="function"&&A(H);export{H as default};
