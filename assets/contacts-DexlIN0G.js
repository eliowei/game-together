import{r as v,av as h,u as F,i as I,d as U,n as V,f as y,g as l,h as a,q as u,v as s,ap as j,t as d,V as c,am as w,an as q,j as x,aw as P,aq as D,F as _,s as R,as as $,ar as z,k as G,y as H}from"./index-B1NrRx6B.js";import{b as T}from"./route-block-B_A1xBdJ.js";import{V as J,a as A}from"./VRow-CqYwbDVl.js";import{V as K}from"./VDataTable-7nn5Pgmt.js";import{V as M}from"./VContainer-CJIQDdmk.js";import{a as O,V as Q}from"./VList-C-cNOl_I.js";import"./VPagination-TTY6pTrz.js";import"./VSelect-Ba1H83Ob.js";import"./VMenu-fm70IgU3.js";import"./VChip-DyHpCdvL.js";import"./VDivider-BJVvPLnP.js";const W={class:"text-center mb-2"},X={class:"d-flex justify-center mb-5"},Y={__name:"contacts",setup(Z){const m=v(""),f=h([]),{t:i}=F(),{apiAuth:k}=H(),g=I(),B=[{title:i("admin.contactName"),key:"nickname",sortable:!0},{title:i("admin.contactEmail"),key:"email",sortable:!0},{title:i("admin.contactTitle"),key:"title",sortable:!0},{title:i("admin.contactDescription"),key:"description",sortable:!0},{title:i("admin.contactDate"),key:"createdAt",sortable:!0},{title:"",key:"action",sortable:!1},{title:"",key:"delete",sortable:!1}],L=U(()=>[{title:i("admin.contactName"),value:o.value.nickname},{title:i("admin.contactEmail"),value:o.value.email},{title:i("admin.contactTitle"),value:o.value.title},{title:i("admin.contactDescription"),value:o.value.description}]),C=async()=>{var n,t;try{const{data:e}=await k.get("/contactform/all");f.push(...e.result)}catch(e){console.log(e),g({text:i("api."+(((t=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"red"}})}};C();const N=async n=>{try{await k.delete("/contactform/"+n._id),f.length=0,await C(),g({text:i("admin.contactDeleted"),snackbarProps:{color:"green"}})}catch(t){console.log(t)}},o=v({open:!1,id:"",nickname:"",email:"",title:"",description:""}),r=v({open:!1,data:""}),E=n=>{r.value.open=!0,r.value.data=n},b=n=>{n==="cancel"?r.value.open=!1:n==="confirm"&&(N(r.value.data),r.value.open=!1)},S=n=>{o.value.id=n._id,o.value.nickname=n.nickname,o.value.email=n.email,o.value.title=n.title,o.value.description=n.description,o.value.open=!0};return(n,t)=>(V(),y(_,null,[l(M,{class:"admin__contact","max-width":"1440"},{default:a(()=>[l(J,null,{default:a(()=>[l(A,{cols:"11",offset:"0","offset-sm":"0","offset-md":"0","offset-lg":"0","offset-xl":"1"},{default:a(()=>[u("h1",W,s(n.$t("nav.adminContacts")),1),l(A,{cols:"12"},{default:a(()=>[u("div",X,[l(j,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),"prepend-inner-icon":"mdi-magnify",variant:"outlined","max-width":"500"},null,8,["modelValue"])]),l(K,{items:f,headers:B,search:m.value},{"item.description":a(({value:e})=>[u("span",null,s(e.length>20?e.slice(0,20)+"...":e),1)]),"item.createdAt":a(({value:e})=>[d(s(new Date(e).toLocaleString()),1)]),"item.action":a(({item:e})=>[l(c,{onClick:p=>S(e)},{default:a(()=>[d(s(n.$t("admin.contactView")),1)]),_:2},1032,["onClick"])]),"item.delete":a(({item:e})=>[l(c,{onClick:p=>E(e)},{default:a(()=>[d(s(n.$t("admin.contactDelete")),1)]),_:2},1032,["onClick"])]),_:2},1032,["items","search"])]),_:1})]),_:1})]),_:1})]),_:1}),l($,{modelValue:o.value.open,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value.open=e),"max-width":"400"},{default:a(()=>[l(w,null,{default:a(()=>[l(q,{class:"d-flex align-center mb-0 pb-0"},{default:a(()=>[u("span",null,s(x(i)("adminContact.view")),1),l(P),l(c,{icon:"mdi-close",variant:"text",onClick:t[1]||(t[1]=e=>o.value.open=!1)})]),_:1}),l(D,{class:"pt-0"},{default:a(()=>[l(O,null,{default:a(()=>[(V(!0),y(_,null,R(x(L),(e,p)=>(V(),G(Q,{class:"py-0",key:p},{default:a(()=>[d(s(e.title)+": "+s(e.value),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l($,{modelValue:r.value.open,"onUpdate:modelValue":t[5]||(t[5]=e=>r.value.open=e),width:"350"},{default:a(()=>[l(w,null,{default:a(()=>[l(D,null,{default:a(()=>t[6]||(t[6]=[d("確定要刪除揪團嗎?")])),_:1}),l(z,null,{default:a(()=>[l(c,{onClick:t[3]||(t[3]=e=>b("cancel"))},{default:a(()=>t[7]||(t[7]=[d("取消")])),_:1}),l(c,{onClick:t[4]||(t[4]=e=>b("confirm"))},{default:a(()=>t[8]||(t[8]=[d("確定")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};typeof T=="function"&&T(Y);export{Y as default};
