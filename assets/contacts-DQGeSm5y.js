import{u as F,i as I,m as v,c as b,d as l,e as a,q as u,v as s,aw as U,V as d,t as c,as as x,au as h,f as D,aC as z,ax as w,F as _,s as P,g as j,az as $,ay as q,r as V,aD as R,y as G,z as H}from"./index-DGDPAFvN.js";import{b as T}from"./route-block-B_A1xBdJ.js";import{V as J,a as A}from"./VRow-B0E1-WBI.js";import{V as K}from"./VDataTable-Selpb8cJ.js";import{V as M}from"./VContainer-DRMGm2hx.js";import{V as O,a as Q}from"./VList-D0O-dBcK.js";import"./VPagination-k2GtoYxE.js";import"./VSelect-D7It98hi.js";import"./VMenu-BCtUym_C.js";import"./VDivider-C7U-UNkw.js";import"./VChip-BLJmKbnz.js";const W={class:"text-center mb-2"},X={class:"d-flex justify-center mb-5"},Y={__name:"contacts",setup(Z){const m=V(""),f=R([]),{t:i}=F(),{apiAuth:k}=H(),g=I(),B=[{title:i("admin.contactName"),key:"nickname",sortable:!0},{title:i("admin.contactEmail"),key:"email",sortable:!0},{title:i("admin.contactTitle"),key:"title",sortable:!0},{title:i("admin.contactDescription"),key:"description",sortable:!0},{title:i("admin.contactDate"),key:"createdAt",sortable:!0},{title:"",key:"action",sortable:!1},{title:"",key:"delete",sortable:!1}],L=G(()=>[{title:i("admin.contactName"),value:o.value.nickname},{title:i("admin.contactEmail"),value:o.value.email},{title:i("admin.contactTitle"),value:o.value.title},{title:i("admin.contactDescription"),value:o.value.description}]),C=async()=>{var n,t;try{const{data:e}=await k.get("/contactform/all");f.push(...e.result)}catch(e){console.log(e),g({text:i("api."+(((t=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"red"}})}};C();const N=async n=>{try{await k.delete("/contactform/"+n._id),f.length=0,await C(),g({text:i("admin.contactDeleted"),snackbarProps:{color:"green"}})}catch(t){console.log(t)}},o=V({open:!1,id:"",nickname:"",email:"",title:"",description:""}),r=V({open:!1,data:""}),E=n=>{r.value.open=!0,r.value.data=n},y=n=>{n==="cancel"?r.value.open=!1:n==="confirm"&&(N(r.value.data),r.value.open=!1)},S=n=>{o.value.id=n._id,o.value.nickname=n.nickname,o.value.email=n.email,o.value.title=n.title,o.value.description=n.description,o.value.open=!0};return(n,t)=>(v(),b(_,null,[l(M,{class:"admin__contact","max-width":"1440"},{default:a(()=>[l(J,null,{default:a(()=>[l(A,{cols:"11",offset:"0","offset-sm":"0","offset-md":"0","offset-lg":"0","offset-xl":"1"},{default:a(()=>[u("h1",W,s(n.$t("nav.adminContacts")),1),l(A,{cols:"12"},{default:a(()=>[u("div",X,[l(U,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),"prepend-inner-icon":"mdi-magnify",variant:"outlined","max-width":"500"},null,8,["modelValue"])]),l(K,{items:f,headers:B,search:m.value},{"item.description":a(({value:e})=>[u("span",null,s(e.length>20?e.slice(0,20)+"...":e),1)]),"item.createdAt":a(({value:e})=>[c(s(new Date(e).toLocaleString()),1)]),"item.action":a(({item:e})=>[l(d,{onClick:p=>S(e)},{default:a(()=>[c(s(n.$t("admin.contactView")),1)]),_:1},8,["onClick"])]),"item.delete":a(({item:e})=>[l(d,{onClick:p=>E(e)},{default:a(()=>[c(s(n.$t("admin.contactDelete")),1)]),_:1},8,["onClick"])]),_:2},1032,["items","search"])]),_:1})]),_:1})]),_:1})]),_:1}),l($,{modelValue:o.value.open,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value.open=e),"max-width":"400"},{default:a(()=>[l(x,null,{default:a(()=>[l(h,{class:"d-flex align-center mb-0 pb-0"},{default:a(()=>[u("span",null,s(D(i)("adminContact.view")),1),l(z),l(d,{icon:"mdi-close",variant:"text",onClick:t[1]||(t[1]=e=>o.value.open=!1)})]),_:1}),l(w,{class:"pt-0"},{default:a(()=>[l(O,null,{default:a(()=>[(v(!0),b(_,null,P(D(L),(e,p)=>(v(),j(Q,{class:"py-0",key:p},{default:a(()=>[c(s(e.title)+": "+s(e.value),1)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l($,{modelValue:r.value.open,"onUpdate:modelValue":t[5]||(t[5]=e=>r.value.open=e),width:"350"},{default:a(()=>[l(x,null,{default:a(()=>[l(w,null,{default:a(()=>[...t[6]||(t[6]=[c("確定要刪除揪團嗎?",-1)])]),_:1}),l(q,null,{default:a(()=>[l(d,{onClick:t[3]||(t[3]=e=>y("cancel"))},{default:a(()=>[...t[7]||(t[7]=[c("取消",-1)])]),_:1}),l(d,{onClick:t[4]||(t[4]=e=>y("confirm"))},{default:a(()=>[...t[8]||(t[8]=[c("確定",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};typeof T=="function"&&T(Y);export{Y as default};
