import{u as R,a as H,i as J,c as K,r as D,z as Q,b as X,d as b,w as Y,e as Z,f as m,g as r,h as t,j as d,k as n,m as i,n as ee,F as g,o,V as _,p,q as w,s as x,t as f,v as C,x as te,A as j,y as oe}from"./index-hejcbg2k.js";import{V as ae,a as S,b as re,c as le}from"./VNavigationDrawer-C2FrYSFW.js";import{V as U}from"./VContainer--v0OXicP.js";import{V as c,a as L,b as W}from"./VList-CmiqK28k.js";import{V as $}from"./VChip-0DMU6feQ.js";import{V as h}from"./VDivider-BWmcKJlk.js";const ne={class:"d-flex mr-6"},se={class:"d-flex"},ie={class:"d-flex flex-column ml-3 justify-center"},ue={class:"mr-3"},de={class:"d-flex justify-space-between align-center"},ye={__name:"members",setup(ce){const{t:v}=R(),l=H(),{apiAuth:I}=oe(),F=J(),O=K(),z=D([]),N=Q(),{mdAndUp:y}=X(),T=b(()=>l.tags),k=D(!1),s=D(!1),A=b(()=>[{to:"/group",text:v("nav.groupList"),icon:"mdi-invoice-list-outline",show:l.isLoggedIn||!l.isLoggedIn},{to:"/creategroup/step1",text:v("nav.groupCreate"),icon:"mdi-flag-outline",show:l.isLoggedIn||!l.isLoggedIn},{to:"/member",text:v("nav.membersSection"),icon:"mdi-account-group",show:l.isLoggedIn},{to:"/admin",text:v("nav.adminSection"),icon:"mdi-cog",show:l.isLoggedIn&&l.isAdmin},{to:"/contact",text:v("nav.contactUs"),icon:"mdi-chat",show:l.isLoggedIn||!l.isLoggedIn},{to:"/login",text:v("nav.login"),icon:"mdi-account-arrow-left",show:!l.isLoggedIn},{to:"/register",text:v("nav.register"),icon:"mdi-account-plus",show:!l.isLoggedIn}]),P=b(()=>[{title:"主辦的揪團",icon:"",to:"/member/organizer"},{title:"參加的揪團",icon:"",to:"/member/participation"},{title:"收藏的揪團",icon:"",to:"/member/favorites"}]),M=b(()=>[{title:"個人資訊",icon:"",to:"/member/info"},{title:"個人標籤",icon:"",to:"/member/tag"}]),B=async()=>{try{await I.delete("/user/logout")}catch(u){console.log(u)}l.logout(),F({text:v("logout.success"),snackbarProps:{color:"green"}}),k.value=!1,O.push("/")};(async()=>{try{const u=await Promise.all([I.get("/user/organizerGroup"),I.get("/user/joinGroup")]);for(let a=0;a<u.length;a++)z.value.push(...u[a].data.result)}catch(u){console.log(u)}})();const G=b(()=>{const u=N.startOfWeek(new Date),a=N.endOfWeek(new Date);return z.value.filter(V=>{const e=new Date(V.group_id.time),q=e>=u&&e<=a,E=e>=new Date;return q&&E}).sort((V,e)=>new Date(V.group_id.time)-new Date(e.group_id.time)).slice(0,3)});return Y(y,u=>{console.log(u),u&&(k.value&&(k.value=!1),s.value&&(s.value=!1)),u||s.value||(s.value=!0)}),(u,a)=>{const V=Z("router-view");return o(),m(g,null,[r(ae,null,{default:t(()=>[d(y)?(o(),n(U,{key:0,class:"d-flex justify-space-between align-center",fluid:""},{default:t(()=>[r(_,{to:"/",active:!1,class:"ml-2"},{default:t(()=>a[5]||(a[5]=[p("Game Together")])),_:1}),w("div",ne,[(o(!0),m(g,null,x(A.value,e=>(o(),m(g,{key:e.to},[e.show?(o(),n(_,{key:0,to:e.to,"prepend-icon":e.icon},{default:t(()=>[p(f(e.text),1)]),_:2},1032,["to","prepend-icon"])):i("",!0)],64))),128)),d(l).isLoggedIn?(o(),n(_,{key:0,"prepend-icon":"mdi-account-arrow-right",onClick:B},{default:t(()=>[p(f(u.$t("nav.logout")),1)]),_:1})):i("",!0),r(C,{border:"xs",image:d(l).avatar},null,8,["image"])])]),_:1})):d(y)?i("",!0):(o(),n(U,{key:1,class:"d-flex justify-space-between align-center",fluid:""},{default:t(()=>[r(_,{to:"/",active:!1,class:"ml-2"},{default:t(()=>a[6]||(a[6]=[p("Game Together")])),_:1}),r(le,{onClick:a[0]||(a[0]=e=>k.value=!k.value),class:"mr-6"})]),_:1}))]),_:1}),d(y)?i("",!0):(o(),n(S,{key:0,modelValue:k.value,"onUpdate:modelValue":a[2]||(a[2]=e=>k.value=e),temporary:"",location:"top"},{default:t(()=>[r(L,null,{default:t(()=>[(o(!0),m(g,null,x(A.value,e=>(o(),m(g,null,[e.show?(o(),n(c,{key:0,to:e.to,"prepend-icon":e.icon},{default:t(()=>[p(f(e.text),1)]),_:2},1032,["to","prepend-icon"])):i("",!0)],64))),256)),d(l).isLoggedIn?(o(),n(c,{key:0,onClick:a[1]||(a[1]=()=>{B(),k.value=!1}),"prepend-icon":"mdi-account-arrow-right"},{default:t(()=>[p(f(u.$t("nav.logout")),1)]),_:1})):i("",!0)]),_:1})]),_:1},8,["modelValue"])),r(S,{permanent:"",rail:s.value,"rail-width":"90",drawer:"drawer",onClick:a[4]||(a[4]=e=>d(y)?null:s.value=!1),width:"260",class:ee({"cursor-pointer":s.value})},{default:t(()=>[s.value?(o(),n(L,{key:0},{default:t(()=>[r(c,null,{default:t(()=>[r(C,{image:d(l).avatar,size:"50"},null,8,["image"])]),_:1})]),_:1})):i("",!0),s.value?i("",!0):(o(),n(L,{key:1},{default:t(()=>[r(c,null,{default:t(()=>[w("div",se,[r(C,{image:d(l).avatar,size:"50"},null,8,["image"]),w("div",ie,[w("span",ue,f(d(l).nickname),1),w("span",null,f(d(l).email),1)]),d(y)?i("",!0):(o(),n(_,{key:0,icon:"mdi-chevron-left",size:"40",variant:"text",onClick:a[3]||(a[3]=te(e=>s.value=!0,["stop"]))}))])]),_:1}),r(c,null,{default:t(()=>[(o(!0),m(g,null,x(T.value,e=>(o(),n($,{"prepend-icon":"mdi-tag",key:e,class:"mr-2 mb-1 pt-1",size:"small",variant:"outlined"},{default:t(()=>[p(f(e),1)]),_:2},1024))),128))]),_:1})]),_:1})),s.value?i("",!0):(o(),n(h,{key:2})),s.value?i("",!0):(o(),n(L,{key:3},{default:t(()=>[r(W,{value:"Numbers"},{activator:t(({props:e})=>[r(c,j(e,{"prepend-icon":"mdi-account-circle",title:"我的揪團"}),null,16)]),default:t(()=>[(o(!0),m(g,null,x(P.value,e=>(o(),n(c,{key:e.to,"prepend-icon":e.icon,title:e.title,to:e.to},null,8,["prepend-icon","title","to"]))),128))]),_:1})]),_:1})),s.value?i("",!0):(o(),n(L,{key:4},{default:t(()=>[r(W,{value:"Users"},{activator:t(({props:e})=>[r(c,j(e,{"prepend-icon":"mdi-account-circle",title:"我的資訊"}),null,16)]),default:t(()=>[(o(!0),m(g,null,x(M.value,e=>(o(),n(c,{key:e.to,"prepend-icon":e.icon,title:e.title,to:e.to},null,8,["prepend-icon","title","to"]))),128))]),_:1})]),_:1})),s.value?i("",!0):(o(),n(h,{key:5})),s.value?i("",!0):(o(),n(c,{key:6,class:"w-100"},{default:t(()=>[w("div",de,[a[8]||(a[8]=w("span",{class:"font-weight-bold"},"本周揪團",-1)),r(_,{to:"/member/date","append-icon":"mdi-arrow-top-right",variant:"text",ripple:!1,active:!1},{default:t(()=>a[7]||(a[7]=[p(" 詳細月曆 ")])),_:1})])]),_:1})),s.value?i("",!0):(o(!0),m(g,{key:7},x(G.value,e=>(o(),m(g,null,[r(h),r(c,{style:{"font-size":"14px"}},{default:t(()=>[p(f(e.group_id.name)+" "+f(e.group_id.type)+" ",1),r($,{class:"ml-1","prepend-icon":"mdi-clock-time-four-outline"},{default:t(()=>[p(f(new Date(e.group_id.time).toLocaleDateString()),1)]),_:2},1024)]),_:2},1024)],64))),256)),s.value?i("",!0):(o(),n(h,{key:8})),G.value.length===0&&!s.value?(o(),n(c,{key:9},{default:t(()=>a[9]||(a[9]=[p("本周無揪團")])),_:1})):i("",!0)]),_:1},8,["rail","class"]),r(re,null,{default:t(()=>[r(V)]),_:1})],64)}}};export{ye as default};
