import{r as D,d as c,B as $,n as l,k as _,h as r,g as n,q as w,v as b,V as S,t as L,j as f,f as m,s as B,F as V,l as R,m as P,C as T,A as j}from"./index-Bq56h7iZ.js";import{_ as I}from"./GroupCard-C068V8xV.js";import{b as A}from"./route-block-B_A1xBdJ.js";import{a as d,V as M}from"./VRow-B-Ai7dIa.js";import{V as O}from"./VPagination-ChKY69Nl.js";import{V as q}from"./VContainer-Dp8PARB0.js";import{V as K}from"./VDivider-Bb63vThF.js";import"./VChip-ByqqnQdA.js";const U={class:"text-h6 mb-3"},z={key:0,class:"text-center"},p=3,H={__name:"favorites",setup(J){const{apiAuth:E}=j(),u=D(1),F=c(()=>Math.ceil(y.value/p)),h=$(),v=D([]),g=D(1),x=c(()=>{const t=v.value.filter(s=>{const a=new Date(s.group_id.time),i=new Date;switch(g.value){case 1:return a>=i;case 2:return a<i;default:return!0}}),e={},o=new Date().toLocaleDateString();return e[o]=[],t.forEach(s=>{const a=new Date(s.group_id.time).toLocaleDateString();e[a]||(e[a]=[]),e[a].push(s)}),Object.entries(e).map(([s,a])=>({date:s,groups:a.sort((i,N)=>new Date(i.group_id.time)-new Date(N.group_id.time))})).sort((s,a)=>new Date(s.date)-new Date(a.date))}),y=c(()=>x.value.reduce((t,e)=>t+e.groups.length,0)),k=c(()=>{const t=[];let e=0;const o=new Date().toLocaleDateString();for(const s of x.value){const a={date:s.date,groups:[]};for(const i of s.groups)e>=(u.value-1)*p&&e<u.value*p&&a.groups.push(i),e++;(a.groups.length>0||s.date===o&&u.value===1&&g.value===1)&&t.push(a)}return t}),C=t=>{g.value=t,u.value=1},G=c(()=>k.value.some(t=>t.groups.length>0||t.date===new Date().toLocaleDateString()&&g.value===1));return(async()=>{const{data:t}=await E.get("/user/favoriteGroup");v.value.push(...t.result),console.log(v.value)})(),(t,e)=>(l(),_(q,{"max-width":"1440"},{default:r(()=>[n(M,null,{default:r(()=>[n(d,{cols:"11","offset-sm":"1","offset-md":"1","offset-lg":"1","offset-xl":"1"},{default:r(()=>[w("h1",null,b(t.$t("member.favorite")),1)]),_:1}),n(d,{cols:"11",offset:"1"},{default:r(()=>[n(S,{onClick:e[0]||(e[0]=o=>C(1)),class:"mr-3"},{default:r(()=>e[3]||(e[3]=[L("將要開始")])),_:1}),n(S,{onClick:e[1]||(e[1]=o=>C(2))},{default:r(()=>e[4]||(e[4]=[L("已結束")])),_:1})]),_:1}),f(G)?(l(!0),m(V,{key:0},B(f(k),o=>(l(),m(V,{key:o.date},[n(d,{cols:"11",offset:"0","offset-sm":"1",sm:"11","offset-md":"1",md:"8","offset-lg":"1",lg:"8","offset-xl":"1",xl:"8"},{default:r(()=>[w("div",U,b(o.date===new Date().toLocaleDateString()?"今天":f(h).format(o.date,"weekday")+" "+f(h).format(o.date,"monthAndDate")),1),n(K,{class:"border-opacity-100 mb-8"}),!o.groups.length&&o.date===new Date().toLocaleDateString()?(l(),m("div",z," 今天沒有符合條件的揪團 ")):P("",!0)]),_:2},1024),n(d,{cols:"12",offset:"0","offset-sm":"1",sm:"12","offset-md":"1",md:"8","offset-lg":"1",lg:"8","offset-xl":"1",xl:"8"},{default:r(()=>[(l(!0),m(V,null,B(o.groups,s=>(l(),m("div",{key:s._id},[n(I,T({ref_for:!0},s.group_id),null,16)]))),128))]),_:2},1024)],64))),128)):(l(),_(d,{key:1,cols:"12",class:"text-center"},{default:r(()=>e[5]||(e[5]=[w("div",{class:"text-h6 text-grey"},"沒有符合條件的揪團",-1)])),_:1})),n(d,{cols:"12"},{default:r(()=>[f(y)>p?(l(),_(O,{key:0,modelValue:f(u),"onUpdate:modelValue":e[2]||(e[2]=o=>R(u)?u.value=o:null),length:f(F),class:"group__pagination"},null,8,["modelValue","length"])):P("",!0)]),_:1})]),_:1})]),_:1}))}};typeof A=="function"&&A(H);export{H as default};
